<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£è¡Œæ—¥å¿— - 2025 å®Œç¾ä¿®å¤ç‰ˆ</title>
    <style>
        /* === åŸºç¡€æ ·å¼ === */
        :root { --primary: #2563eb; --bg: #f1f5f9; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: var(--bg); color: #334155;
            padding: 20px; min-height: 100vh;
        }
        .container { max-width: 1100px; margin: 0 auto; display: flex; flex-direction: column; gap: 20px; }

        /* å¡ç‰‡é€šç”¨ */
        .card {
            background: white; border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            overflow: hidden; border: 1px solid #e2e8f0;
        }
        .card-header {
            padding: 15px 20px; background: linear-gradient(to right, #f8fafc, #fff);
            border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;
        }
        .card-header h2 { font-size: 1.1rem; color: #1e293b; font-weight: 700; }
        .card-body { padding: 20px; }

        /* é¡¶éƒ¨æ  */
        .top-bar {
            display: flex; justify-content: space-between; align-items: center;
            background: var(--primary); color: white; padding: 15px 25px;
            border-radius: 16px; box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.3);
        }

        /* è¡¨å•ä¸æŠ¥è¡¨ */
        .table-scroll { overflow-x: auto; border-radius: 8px; border: 1px solid #cbd5e1; }
        .excel-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; min-width: 900px; }
        .excel-table th, .excel-table td { border: 1px solid #cbd5e1; padding: 8px 6px; text-align: center; }
        .excel-table th { background: #f1f5f9; font-weight: 600; }
        .bg-sub { background-color: #fdf4ff; color: #86198f; font-weight: bold; }

        .ai-input-area { position: relative; }
        .key-input { 
            position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.9);
            padding: 5px 10px; border-radius: 6px; border: 1px solid #cbd5e1; font-size: 0.8rem; width: 200px;
        }
        textarea {
            width: 100%; height: 100px; padding: 15px; border: 2px dashed #cbd5e1;
            border-radius: 12px; resize: vertical; font-family: monospace; background: #f8fafc;
        }
        
        .edit-form { background: #f8fafc; padding: 20px; border-radius: 12px; margin-top: 15px; border: 1px solid #e2e8f0; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px; }
        .form-full-width { grid-column: 1 / -1; }
        .form-group label { display: block; font-size: 0.75rem; margin-bottom: 4px; font-weight: 600; }
        .form-group input, .form-group select { width: 100%; padding: 8px; border: 1px solid #cbd5e1; border-radius: 6px; }
        
        .time-group { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; background: white; padding: 10px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .time-group input { border: none; background: #f1f5f9; text-align: center; padding: 4px; width: 100%; }
        .time-group label { font-size: 0.7rem; color: #94a3b8; text-align: center; display: block;}

        /* === å†å²è®°å½• (ä¿®å¤ç‰ˆ) === */
        .log-list { max-height: 600px; overflow-y: auto; }
        .log-item {
            background: white; border: 1px solid #e2e8f0; border-radius: 10px;
            margin-bottom: 12px; padding: 15px; transition: 0.2s;
        }
        .log-item:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.05); }

        /* å¤´éƒ¨æ”¹ä¸º Flex å¸ƒå±€ï¼Œç¡®ä¿æŒ‰é’®ä¸è¢«é®æŒ¡ */
        .log-header { 
            display: flex; justify-content: space-between; align-items: flex-start; 
            border-bottom: 1px dashed #e2e8f0; padding-bottom: 8px; margin-bottom: 8px; gap: 10px;
        }
        .log-header-left { flex: 1; }
        .log-date { font-family: monospace; color: #64748b; margin-right: 10px; }
        .log-route { font-weight: 700; color: #1e293b; font-size: 1rem; }

        /* ä¿®å¤åçš„åˆ é™¤æŒ‰é’®æ ·å¼ */
        .btn-del {
            background: #fee2e2; color: #dc2626; border: 1px solid #fecaca;
            padding: 4px 10px; border-radius: 6px; cursor: pointer; font-size: 0.8rem;
            font-weight: bold; white-space: nowrap; flex-shrink: 0;
            transition: 0.2s; z-index: 10; /* æé«˜å±‚çº§ */
        }
        .btn-del:hover { background: #ef4444; color: white; border-color: #ef4444; }

        .log-crew { font-size: 0.85rem; color: #475569; margin-bottom: 8px; }
        .log-times { 
            display: flex; background: #f8fafc; padding: 8px; border-radius: 6px; 
            font-family: monospace; font-size: 0.85rem; justify-content: space-between; color: #334155; margin-bottom: 8px;
        }
        .time-point { text-align: center; }
        .time-label { font-size: 0.7rem; color: #94a3b8; display: block; }
        
        .log-stats { display: flex; gap: 15px; font-size: 0.85rem; color: #1e293b; align-items: center; flex-wrap: wrap; }
        .stat-box { background: #eff6ff; padding: 4px 8px; border-radius: 4px; color: #1d4ed8; font-weight: 500; }
        .tags { display: flex; gap: 5px; margin-left: auto; }
        .tag { padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; background: #e2e8f0; }
        .tag-special { background: #fce7f3; color: #be185d; }
        .tag-holiday { background: #fee2e2; color: #b91c1c; }

        /* æŒ‰é’®ä¸ç™»å½• */
        .btn { padding: 8px 20px; border-radius: 8px; border: none; cursor: pointer; font-weight: 600; }
        .btn-primary { background: var(--primary); color: white; }
        .login-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            display: flex; justify-content: center; align-items: center; z-index: 999;
        }
        .login-box { background: white; padding: 40px; border-radius: 20px; text-align: center; width: 320px; }
    </style>
</head>
<body>

    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <h2 style="color: var(--primary); margin-bottom: 20px;">âœˆï¸ é£è¡Œæ—¥å¿—</h2>
            <button class="btn btn-primary" style="width: 100%; padding: 12px;" onclick="loginWithGoogle()">Google è´¦å·ç™»å½•</button>
        </div>
    </div>

    <div id="app" class="container" style="display: none;">
        <div class="top-bar">
            <div><h1 style="font-size: 1.25rem;">é£è¡Œå‘˜æ§åˆ¶å°</h1><span id="userInfo" style="font-size: 0.8rem; opacity: 0.9;">æœªç™»å½•</span></div>
            <button class="btn" style="background: rgba(255,255,255,0.2); color: white;" onclick="doLogout()">é€€å‡º</button>
        </div>

        <!-- 1. æŠ¥è¡¨ -->
        <section class="card">
            <div class="card-header">
                <h2>ğŸ“Š è–ªé…¬ç»Ÿè®¡</h2>
                <input type="month" id="reportMonth" onchange="renderReport()" style="border: 1px solid #cbd5e1; padding: 4px; border-radius: 4px;">
            </div>
            <div class="card-body">
                <div class="table-scroll">
                    <table class="excel-table" id="reportTable"></table>
                </div>
            </div>
        </section>

        <!-- 2. å½•å…¥ -->
        <section class="card">
            <div class="card-header">
                <h2>ğŸ“ æ™ºèƒ½å½•å…¥</h2>
                <span style="font-size: 0.8rem; color: #64748b;">å«æ˜ç»†æ•°æ®æå–</span>
            </div>
            <div class="card-body">
                <div class="ai-input-area">
                    <input type="password" id="innerApiKey" class="key-input" placeholder="DeepSeek Key">
                    <textarea id="ocrInput" placeholder="ç¤ºä¾‹ï¼š5æœˆ1æ—¥ CA1234 PEK-SHA æœºé•¿å¼ ä¸‰&#10;å¼€è½¦10:00 èµ·é£10:20 è½åœ°12:20 å…³è½¦12:30&#10;ç©ºä¸­2.0 ç‰¹æ®Šæœºåœº è¿‡å¤œ1å¤©"></textarea>
                </div>
                <div style="text-align: right; margin-top: 10px;">
                    <button id="aiBtn" class="btn btn-primary" onclick="processAI()">âœ¨ AI è¯†åˆ«</button>
                </div>

                <div id="editForm" class="edit-form" style="display: none;">
                    <div class="form-grid">
                        <div class="form-group"><label>æ—¥æœŸ</label><input type="date" id="f_date"></div>
                        <div class="form-group"><label>èµ·é£</label><input type="text" id="f_dep"></div>
                        <div class="form-group"><label>è½åœ°</label><input type="text" id="f_arr"></div>
                        <div class="form-group"><label>åŒºåŸŸ</label>
                            <select id="f_cat">
                                <option value="å›½å†…">å›½å†…</option><option value="æ¸¯æ¾³å°">æ¸¯æ¾³å°</option>
                                <option value="äºšæ´²å›½é™…">äºšæ´²å›½é™…</option><option value="æ´²é™…">æ´²é™…</option>
                            </select>
                        </div>
                        <div class="form-group form-full-width"><label>æœºç»„åå•</label><input type="text" id="f_crew"></div>
                        
                        <div class="form-group form-full-width">
                            <label>è¿è¡Œæ—¶åˆ» (HH:MM)</label>
                            <div class="time-group">
                                <div><label>å¼€è½¦</label><input type="time" id="f_block_off"></div>
                                <div><label>èµ·é£</label><input type="time" id="f_takeoff"></div>
                                <div><label>è½åœ°</label><input type="time" id="f_landing"></div>
                                <div><label>å…³è½¦</label><input type="time" id="f_block_on"></div>
                            </div>
                        </div>

                        <div class="form-group"><label>ç©ºä¸­æ—¶é—´</label><input type="number" step="0.1" id="f_air"></div>
                        <div class="form-group"><label>æ€»æ—¶é—´</label><input type="number" step="0.1" id="f_total_time"></div>
                        <div class="form-group"><label>åœ°é¢æ—¶é—´</label><input type="number" step="0.1" id="f_ground_time"></div>
                        <div class="form-group"><label>æ»‘è¡Œæ¬¡/å¤©</label><input type="number" id="f_block_days" value="1"></div>
                        
                        <div class="form-group"><label>å¤œèˆª18:30+</label><input type="number" step="0.1" id="f_night1"></div>
                        <div class="form-group"><label>å¤œèˆª00:00+</label><input type="number" step="0.1" id="f_night2"></div>
                        <div class="form-group"><label>é©»å¤–ç±»å‹</label>
                            <select id="f_overnight">
                                <option value="å›½å†…æ— è¿‡å¤œ">å›½å†…æ— è¿‡å¤œ</option><option value="å›½å†…æœ‰è¿‡å¤œ">å›½å†…æœ‰è¿‡å¤œ</option>
                                <option value="å›½é™…æ— è¿‡å¤œ">å›½é™…æ— è¿‡å¤œ</option><option value="å›½é™…æœ‰è¿‡å¤œ">å›½é™…æœ‰è¿‡å¤œ</option>
                            </select>
                        </div>
                        <div class="form-group"><label>é©»å¤–å¤©æ•°</label><input type="number" id="f_overnight_days" value="0"></div>
                        <div class="form-group"><label>ç‰¹æ®Šæœºåœº</label><input type="number" id="f_special" value="0"></div>
                        <div class="form-group"><label>èŠ‚å‡æ—¥</label><input type="number" id="f_holiday" value="0"></div>
                    </div>
                    <div style="margin-top: 15px; display: flex; justify-content: flex-end; gap: 10px;">
                        <button class="btn" style="background: #e2e8f0;" onclick="document.getElementById('editForm').style.display='none'">å–æ¶ˆ</button>
                        <button class="btn btn-primary" onclick="saveRecord()">ğŸ’¾ ä¿å­˜</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- 3. å†å² -->
        <section class="card">
            <div class="card-header"><h2>ğŸ“‹ å†å²è®°å½•æ˜ç»†</h2></div>
            <div class="card-body">
                <div id="logList" class="log-list"></div>
            </div>
        </section>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, deleteDoc, doc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyCFk4f7bKUHlb3d1Cg1jyS1EM-SPC4pr40",
            authDomain: "myflightlog-1f4cb.firebaseapp.com",
            projectId: "myflightlog-1f4cb",
            storageBucket: "myflightlog-1f4cb.firebasestorage.app",
            messagingSenderId: "181072044112",
            appId: "1:181072044112:web:ca312da2d4780227cef155"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const provider = new GoogleAuthProvider();
        let currentUser = null, allRecords = [];

        window.loginWithGoogle = async () => { try { await signInWithPopup(auth, provider); } catch (e) { alert(e.message); } };
        window.doLogout = async () => { await signOut(auth); };

        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
                document.getElementById('userInfo').textContent = `ğŸ‘¨â€âœˆï¸ ${user.displayName}`;
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('app').style.display = 'flex';
                document.getElementById('reportMonth').value = new Date().toISOString().slice(0, 7);
                if(localStorage.getItem("openai_key")) document.getElementById("innerApiKey").value = localStorage.getItem("openai_key");

                onSnapshot(query(collection(db, `users/${user.uid}/logs`), orderBy("date", "desc")), (snapshot) => {
                    allRecords = snapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
                    renderList(); renderReport();
                });
            } else {
                document.getElementById('loginScreen').style.display = 'flex';
                document.getElementById('app').style.display = 'none';
            }
        });

        // ä¿®å¤åçš„åˆ é™¤å‡½æ•°ï¼šå¢åŠ  try/catch å’Œ alert
        window.deleteItem = async (id) => {
            if(!currentUser) return alert("æœªç™»å½•");
            if(confirm("âš ï¸ ç¡®å®šè¦æ°¸ä¹…åˆ é™¤è¿™æ¡è®°å½•å—ï¼Ÿ")) {
                try {
                    await deleteDoc(doc(db, `users/${currentUser.uid}/logs`, id));
                    // åˆ é™¤æˆåŠŸåä¸éœ€è¦æ‰‹åŠ¨åˆ·æ–°ï¼ŒonSnapshot ä¼šè‡ªåŠ¨å¤„ç†
                } catch(e) {
                    console.error("åˆ é™¤å¤±è´¥:", e);
                    alert("âŒ åˆ é™¤å¤±è´¥: " + e.message + "\nè¯·æ£€æŸ¥ Firebase åå° Rules æƒé™è®¾ç½®ã€‚");
                }
            }
        };

        window.processAI = async () => {
            const text = document.getElementById('ocrInput').value;
            const apiKey = document.getElementById('innerApiKey').value;
            if (!apiKey) return alert("è¯·è¾“å…¥ Key");
            localStorage.setItem("openai_key", apiKey);

            const btn = document.getElementById('aiBtn');
            btn.textContent = "â³ åˆ†æä¸­..."; btn.disabled = true;

            const prompt = `
            åˆ†æé£è¡Œæ–‡æœ¬è¿”å›JSONã€‚
            å­—æ®µ: date, dep, arr, category("å›½å†…"|"æ¸¯æ¾³å°"|"äºšæ´²å›½é™…"|"æ´²é™…"), crew(string),
            time_off, time_takeoff, time_landing, time_on (HH:MM),
            air_time, total_time, ground_time (float),
            block_days(int), night1, night2 (float),
            overnight, overnight_days(int), special_airport(int), holiday(int)
            æ–‡æœ¬: ${text}
            `;

            try {
                const res = await fetch("https://api.deepseek.com/chat/completions", {
                    method: "POST",
                    headers: { "Content-Type": "application/json", "Authorization": `Bearer ${apiKey}` },
                    body: JSON.stringify({ model: "deepseek-chat", messages: [{role: "user", content: prompt}], temperature: 0.1 })
                });
                const data = await res.json();
                const content = data.choices[0].message.content;
                const r = JSON.parse(content.match(/\{[\s\S]*\}/)[0]);

                const setVal = (id, val) => { const el = document.getElementById(id); if(el) el.value = val || ''; };
                setVal('f_date', r.date); setVal('f_dep', r.dep); setVal('f_arr', r.arr);
                setVal('f_cat', r.category || 'å›½å†…'); setVal('f_crew', r.crew);
                setVal('f_block_off', r.time_off); setVal('f_takeoff', r.time_takeoff);
                setVal('f_landing', r.time_landing); setVal('f_block_on', r.time_on);
                setVal('f_air', r.air_time); setVal('f_total_time', r.total_time); setVal('f_ground_time', r.ground_time);
                setVal('f_block_days', r.block_days || 1); 
                setVal('f_night1', r.night1); setVal('f_night2', r.night2);
                setVal('f_overnight', r.overnight); setVal('f_overnight_days', r.overnight_days);
                setVal('f_special', r.special_airport); setVal('f_holiday', r.holiday);

                document.getElementById('editForm').style.display = 'block';
            } catch (e) { alert("è¯†åˆ«å¤±è´¥: " + e.message); } 
            finally { btn.textContent = "âœ¨ AI è¯†åˆ«"; btn.disabled = false; }
        };

        window.saveRecord = async () => {
            const getNum = (id) => parseFloat(document.getElementById(id).value) || 0;
            const getStr = (id) => document.getElementById(id).value;
            const record = {
                date: getStr('f_date'), dep: getStr('f_dep'), arr: getStr('f_arr'), category: getStr('f_cat'), crew: getStr('f_crew'),
                block_off: getStr('f_block_off'), takeoff: getStr('f_takeoff'), landing: getStr('f_landing'), block_on: getStr('f_block_on'),
                air_time: getNum('f_air'), total_time: getNum('f_total_time'), ground_time: getNum('f_ground_time'),
                block_days: getNum('f_block_days'), night1: getNum('f_night1'), night2: getNum('f_night2'),
                overnight: getStr('f_overnight'), overnight_days: getNum('f_overnight_days'),
                special_airport: getNum('f_special'), holiday: getNum('f_holiday'),
                timestamp: new Date()
            };
            await addDoc(collection(db, `users/${currentUser.uid}/logs`), record);
            document.getElementById('editForm').style.display = 'none';
            document.getElementById('ocrInput').value = '';
        };

        window.renderList = () => {
            const el = document.getElementById('logList');
            el.innerHTML = allRecords.length ? allRecords.map(r => `
                <div class="log-item">
                    <div class="log-header">
                        <div class="log-header-left">
                            <span class="log-date">${r.date}</span>
                            <span class="log-route">${r.dep} â” ${r.arr}</span>
                        </div>
                        <button class="btn-del" onclick="deleteItem('${r.id}')">åˆ é™¤</button>
                    </div>
                    
                    <div class="log-crew">ğŸ‘¨â€âœˆï¸ ${r.crew || '-'}</div>
                    
                    <div class="log-times">
                        <div class="time-point"><span class="time-label">å¼€è½¦</span>${r.block_off||'-'}</div>
                        <div class="time-point"><span class="time-label">èµ·é£</span>${r.takeoff||'-'}</div>
                        <div class="time-point"><span class="time-label">è½åœ°</span>${r.landing||'-'}</div>
                        <div class="time-point"><span class="time-label">å…³è½¦</span>${r.block_on||'-'}</div>
                    </div>

                    <div class="log-stats">
                        <span class="stat-box" title="ç©ºä¸­">â˜ï¸ ${r.air_time}h</span>
                        <span class="stat-box" style="background:#f0fdf4;color:#15803d" title="æ€»æ—¶é—´">âŒš ${r.total_time||0}h</span>
                        <span style="color:#64748b">ğŸšœ ${r.ground_time||0}h</span>
                        <div class="tags">
                            <span class="tag">${r.category}</span>
                            ${r.special_airport > 0 ? `<span class="tag tag-special">ç‰¹</span>` : ''}
                            ${r.holiday > 0 ? `<span class="tag tag-holiday">èŠ‚</span>` : ''}
                        </div>
                    </div>
                </div>
            `).join('') : '<div style="text-align:center;color:#ccc;padding:20px">æ— è®°å½•</div>';
        };

        window.renderReport = () => {
            const mStr = document.getElementById('reportMonth').value;
            const data = allRecords.filter(r => r.date.startsWith(mStr));
            const s = { d_air:0, d_bk:0, h_air:0, h_bk:0, a_air:0, a_bk:0, i_air:0, i_bk:0, n1:0, n2:0, o_d0:0, o_d1:0, o_i0:0, o_i1:0, spec:0, hol:0 };
            
            data.forEach(r => {
                if(r.category==='å›½å†…') { s.d_air+=r.air_time; s.d_bk+=r.block_days; }
                else if(r.category==='æ¸¯æ¾³å°') { s.h_air+=r.air_time; s.h_bk+=r.block_days; }
                else if(r.category==='äºšæ´²å›½é™…') { s.a_air+=r.air_time; s.a_bk+=r.block_days; }
                else { s.i_air+=r.air_time; s.i_bk+=r.block_days; }
                s.n1 += r.night1; s.n2 += r.night2;
                const days = r.overnight_days || 0;
                if(r.overnight==='å›½å†…æ— è¿‡å¤œ') s.o_d0+=days; else if(r.overnight==='å›½å†…æœ‰è¿‡å¤œ') s.o_d1+=days;
                else if(r.overnight==='å›½é™…æ— è¿‡å¤œ') s.o_i0+=days; else s.o_i1+=days;
                s.spec += (r.special_airport || 0); s.hol += (r.holiday || 0);
            });

            document.getElementById('reportTable').innerHTML = `
                <thead>
                    <tr><th rowspan="2">ç±»å‹</th><th colspan="2">å›½å†…</th><th colspan="2">æ¸¯æ¾³å°</th><th colspan="2">äºšæ´²</th><th colspan="2">æ´²é™…</th></tr>
                    <tr><th>ç©º</th><th>æ»‘</th><th>ç©º</th><th>æ»‘</th><th>ç©º</th><th>æ»‘</th><th>ç©º</th><th>æ»‘</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>é£è¡Œ</td>
                        <td>${s.d_air.toFixed(1)}</td><td>${s.d_bk}</td>
                        <td>${s.h_air.toFixed(1)}</td><td>${s.h_bk}</td>
                        <td>${s.a_air.toFixed(1)}</td><td>${s.a_bk}</td>
                        <td>${s.i_air.toFixed(1)}</td><td>${s.i_bk}</td>
                    </tr>
                    <tr><td colspan="9" style="background:#f8fafc;height:8px;padding:0"></td></tr>
                    <tr><th rowspan="2">è¡¥åŠ©</th><th colspan="2">å¤œèˆª</th><th colspan="2">ç‰¹æ®Š/èŠ‚å‡</th><th colspan="2">é©»å¤–(æœ‰)</th><th colspan="2">å…¶ä»–</th></tr>
                    <tr><th>18:30</th><th>00:00</th><th class="bg-sub">ç‰¹æ®Š</th><th class="bg-sub">å‡æ—¥</th><th>å›½æœ‰</th><th>å¤–æœ‰</th><th>-</th><th>-</th></tr>
                    <tr>
                        <td>ç»Ÿè®¡</td>
                        <td>${s.n1.toFixed(1)}</td><td>${s.n2.toFixed(1)}</td>
                        <td class="bg-sub">${s.spec}</td><td class="bg-sub">${s.hol}</td>
                        <td>${s.o_d1}</td><td>${s.o_i1}</td>
                        <td>-</td><td>-</td>
                    </tr>
                </tbody>
            `;
        };
    </script>
</body>
</html>
